# מדריך למשתמש - בוט מסחר TradingView → MT5 (גרסה חינמית)

## תוכן עניינים
1. [סקירה כללית](#1-סקירה-כללית)
2. [דרישות מקדימות](#2-דרישות-מקדימות)
3. [שלב א - העלאת השרת לענן (Render)](#3-שלב-א---העלאת-השרת-לענן-render)
4. [שלב ב - התקנת ה-EA על MT5](#4-שלב-ב---התקנת-ה-ea-על-mt5)
5. [שלב ג - הגדרת התראות ב-TradingView](#5-שלב-ג---הגדרת-התראות-ב-tradingview)
6. [פורמט ההודעות (JSON)](#6-פורמט-ההודעות-json)
7. [ניהול סיכונים](#7-ניהול-סיכונים)
8. [מעקב ובקרה מהטלפון](#8-מעקב-ובקרה-מהטלפון)
9. [VPS חינמי - כדי שה-EA ירוץ 24/7](#9-vps-חינמי---כדי-שה-ea-ירוץ-247)
10. [פתרון בעיות](#10-פתרון-בעיות)
11. [שאלות נפוצות](#11-שאלות-נפוצות)

---

## 1. סקירה כללית

### מה הבוט עושה?
הבוט מקבל התראות (alerts) מאינדיקטורים ב-TradingView ומבצע פקודות מסחר אוטומטיות בחשבון MT5 שלך ב-FTMO.

### איך זה עובד? (100% חינם - בלי MetaApi!)
```
TradingView Alert → שרת ענן (Render) → EA ב-MT5 קורא ומבצע
```

1. **האינדיקטור שלך** ב-TradingView מזהה סיגנל מסחר
2. **TradingView** שולח התראה (webhook) לשרת הבוט בענן
3. **השרת** מקבל את ההתראה ושומר אותה בתור (queue)
4. **ה-Expert Advisor (EA)** שרץ על MT5 בודק כל כמה שניות אם יש סיגנל חדש
5. **ה-EA מבצע את העסקה** ישירות על חשבון MT5 שלך
6. **אתה** עוקב אחרי הכל מהטלפון

### למה זה חינם?
- **אין MetaApi** - ה-EA רץ ישירות על MT5
- **שרת Render** - תוכנית חינמית
- **קוד MQL5** - רץ בתוך MT5 בלי שום שירות חיצוני בתשלום

---

## 2. דרישות מקדימות

| דרישה | עלות | פרטים |
|--------|------|--------|
| חשבון TradingView Pro | ~$13/חודש | צריך Pro כדי לשלוח webhooks |
| חשבון FTMO | יש לך | חשבון MT5 פעיל |
| MT5 פתוח על VPS | חינם | ראה סעיף 9 - VPS חינמי |
| חשבון Render | חינם | לשרת ה-webhook |
| חשבון GitHub | חינם | לאחסון הקוד |

> **חשוב:** ה-EA צריך שטרמינל MT5 יהיה פתוח כל הזמן. אפשר להשיג VPS חינמי (ראה סעיף 9).

---

## 3. שלב א - העלאת השרת לענן (Render)

השרת הוא "תחנת ביניים" שמקבלת סיגנלים מ-TradingView ושומרת אותם עד שה-EA קורא אותם.

### שלב 3.1 - העלאה ל-GitHub
1. היכנס ל-**GitHub** מהטלפון (אפליקציה או דפדפן)
2. צור **Repository חדש** (פרטי - Private)
3. העלה את הקבצים הבאים מתיקיית `trading-bot`:
   - `app.py`
   - `config.py`
   - `requirements.txt`
   - `Procfile`
   - `runtime.txt`

> **אל תעלה:** `.env`, `.env.example`, `TradingViewBot.mq5` (אין צורך בשרת)

### שלב 3.2 - הגדרת Render
1. היכנס ל-**render.com** מהטלפון
2. לחץ **Sign Up** → **התחבר עם GitHub**
3. לחץ **New** → **Web Service**
4. בחר את ה-Repository שיצרת
5. הגדר:
   - **Name:** `my-trading-bot` (או שם שתבחר)
   - **Runtime:** Python 3
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `gunicorn app:app --bind 0.0.0.0:$PORT --workers 1`
   - **Plan:** **Free**

### שלב 3.3 - הגדרת משתני סביבה
ב-Render, לך ל-**Environment** והוסף:

| Key | Value | הסבר |
|-----|-------|-------|
| `WEBHOOK_SECRET` | סיסמה שאתה בוחר | למשל: `MySecret2024!` |
| `DEFAULT_LOT_SIZE` | `0.01` | גודל לוט ברירת מחדל |
| `MAX_LOT_SIZE` | `1.0` | גודל לוט מקסימלי |
| `MAX_OPEN_TRADES` | `5` | מקסימום עסקאות פתוחות |
| `DEFAULT_SL_PIPS` | `50` | סטופ לוס ברירת מחדל |
| `DEFAULT_TP_PIPS` | `100` | טייק פרופיט ברירת מחדל |

6. לחץ **Deploy**
7. חכה שהסטטוס יהיה **Live**
8. **שמור את הכתובת** שתקבל, למשל: `https://my-trading-bot.onrender.com`

### שלב 3.4 - בדיקת השרת
פתח בדפדפן בטלפון:
```
https://my-trading-bot.onrender.com/
```
אם אתה רואה `"status": "running"` - השרת עובד!

---

## 4. שלב ב - התקנת ה-EA על MT5

ה-Expert Advisor (EA) רץ בתוך MT5 ובודק כל כמה שניות אם יש סיגנל חדש מהשרת.

### שלב 4.1 - העתקת קובץ ה-EA

צריך להעתיק את הקובץ `TradingViewBot.mq5` לתיקיית ה-Experts של MT5.

**אם יש לך VPS (ראה סעיף 9):**
1. התחבר ל-VPS דרך **Remote Desktop** מהטלפון (אפליקציית RD Client)
2. פתח את **MT5** ב-VPS
3. בתפריט העליון: **File** → **Open Data Folder**
4. נווט ל: `MQL5` → `Experts`
5. העתק את קובץ `TradingViewBot.mq5` לתיקייה הזו

**דרך נוספת - ישירות דרך MetaEditor:**
1. פתח MT5 ב-VPS
2. לחץ על **MetaEditor** (F4 או אייקון בסרגל)
3. צור קובץ חדש: **File** → **New** → **Expert Advisor**
4. שם: `TradingViewBot`
5. מחק את כל התוכן והדבק את הקוד מקובץ `TradingViewBot.mq5`
6. לחץ **Compile** (F7)
7. ודא שאין שגיאות (0 errors)

### שלב 4.2 - הפעלת ה-EA

1. חזור ל-MT5 (לא MetaEditor)
2. פתח **גרף כלשהו** (לא משנה איזה - ה-EA עובד על כל הסימבולים)
3. בצד שמאל, פתח את **Navigator** → **Expert Advisors**
4. **גרור** את `TradingViewBot` על הגרף
5. בחלון ההגדרות שנפתח, מלא:

| שדה | ערך | הסבר |
|------|------|-------|
| **ServerURL** | `https://my-trading-bot.onrender.com` | כתובת השרת מסעיף 3 |
| **WebhookSecret** | `MySecret2024!` | אותו secret שהגדרת ב-Render |
| **PollInterval** | `3` | כל כמה שניות לבדוק סיגנלים |
| **MaxOpenTrades** | `5` | מקסימום עסקאות פתוחות |
| **MaxLotSize** | `1.0` | גודל לוט מקסימלי |
| **Slippage** | `10` | החלקה מקסימלית בנקודות |
| **MagicNumber** | `123456` | מזהה ייחודי לעסקאות הבוט |

6. לחץ **OK**

### שלב 4.3 - הפעלת WebRequest (חשוב!)

ה-EA צריך אישור לתקשר עם השרת:

1. ב-MT5: **Tools** → **Options** → **Expert Advisors**
2. סמן **Allow automated trading**
3. סמן **Allow WebRequest for listed URL**
4. לחץ **Add** והכנס: `https://my-trading-bot.onrender.com`
5. לחץ **OK**
6. **ודא** שכפתור **AutoTrading** בסרגל העליון **מופעל** (ירוק)

### שלב 4.4 - אימות שה-EA עובד

בלשונית **Experts** (בתחתית MT5) אתה אמור לראות:
```
TradingView Bot EA initialized
Server: https://my-trading-bot.onrender.com
Server connection OK
```

אם תראה שגיאת WebRequest - חזור לשלב 4.3.

---

## 5. שלב ג - הגדרת התראות ב-TradingView

### שלב 5.1 - הגדרת התראה
1. פתח **TradingView** בטלפון
2. פתח את הגרף עם **האינדיקטור שלך**
3. לחץ על **Alert** (פעמון)
4. הגדר את **התנאי** (condition) של האינדיקטור

### שלב 5.2 - הגדרת Webhook
1. בהגדרות ההתראה, סמן **Webhook URL**
2. הכנס:
   ```
   https://my-trading-bot.onrender.com/webhook
   ```

### שלב 5.3 - הגדרת הודעה (Message)
בשדה **Message**, הכנס JSON:

**לפקודת קנייה (BUY):**
```json
{
  "secret": "MySecret2024!",
  "action": "buy",
  "symbol": "EURUSD",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```

**לפקודת מכירה (SELL):**
```json
{
  "secret": "MySecret2024!",
  "action": "sell",
  "symbol": "EURUSD",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```

**לסגירת עסקאות על סימבול:**
```json
{
  "secret": "MySecret2024!",
  "action": "close",
  "symbol": "EURUSD"
}
```

**לסגירת כל העסקאות:**
```json
{
  "secret": "MySecret2024!",
  "action": "close_all"
}
```

### שלב 5.4 - שימוש עם משתני TradingView (דינמי)
אם האינדיקטור שלך מייצר סיגנלים אוטומטיים:
```json
{
  "secret": "MySecret2024!",
  "action": "{{strategy.order.action}}",
  "symbol": "{{ticker}}",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```
> `{{strategy.order.action}}` מחזיר `buy` או `sell` אוטומטית.

---

## 6. פורמט ההודעות (JSON)

### פקודות נתמכות

| פקודה | action | שדות נדרשים | שדות אופציונליים |
|--------|--------|-------------|-----------------|
| קנייה | `buy` | `symbol` | `lot_size`, `sl_pips`, `tp_pips` |
| מכירה | `sell` | `symbol` | `lot_size`, `sl_pips`, `tp_pips` |
| סגירת סימבול | `close` | `symbol` | - |
| סגירת הכל | `close_all` | - | - |

### סימבולים נפוצים

| סימבול | שם |
|--------|-----|
| `EURUSD` | EUR/USD |
| `GBPUSD` | GBP/USD |
| `USDJPY` | USD/JPY |
| `XAUUSD` | זהב |
| `US30` | Dow Jones |
| `NAS100` | Nasdaq |

> **חשוב:** הסימבול חייב להתאים **בדיוק** לשם ב-MT5. בדוק באפליקציית MT5 שלך.

---

## 7. ניהול סיכונים

### הגבלות מובנות ב-EA
- **MaxLotSize:** ה-EA לא יפתח עסקה גדולה מהמקסימום
- **MaxOpenTrades:** ה-EA יסרב לפתוח עסקאות חדשות אם הגעת למקסימום
- **SL אוטומטי:** כל עסקה נפתחת עם סטופ לוס
- **TP אוטומטי:** כל עסקה נפתחת עם טייק פרופיט
- **MagicNumber:** מזהה ייחודי - ה-EA סופר רק עסקאות שלו

### הגבלות מובנות בשרת
- **MAX_LOT_SIZE:** השרת חותך לוטים גדולים מדי עוד לפני שהם מגיעים ל-EA
- **Secret:** בלי הסיסמה הנכונה, אף אחד לא יכול לשלוח פקודות

### המלצות ל-FTMO
- **גודל לוט:** התחל עם `0.01` ותעלה בהדרגה
- **סטופ לוס:** תמיד! FTMO דורשים ניהול סיכונים
- **הפסד יומי:** שים לב למגבלת 5% של FTMO
- **הפסד מקסימלי:** שים לב למגבלת 10% של FTMO
- **תתחיל עם דמו:** תבדוק שהאינדיקטור עובד טוב לפני כסף אמיתי

---

## 8. מעקב ובקרה מהטלפון

### בדיקת סטטוס השרת
```
https://my-trading-bot.onrender.com/
```
מראה: סטטוס, מספר סיגנלים בתור.

### צפייה בהיסטוריית עסקאות
```
https://my-trading-bot.onrender.com/trades
```
מראה את 100 העסקאות האחרונות (סיגנלים שנשלחו + תוצאות).

### צפייה בתור סיגנלים
```
https://my-trading-bot.onrender.com/queue?secret=MySecret2024!
```
מראה סיגנלים שעדיין מחכים לביצוע.

### עצירת חירום - מחיקת כל הסיגנלים
שלח POST ל:
```
https://my-trading-bot.onrender.com/clear
```
עם body:
```json
{"secret": "MySecret2024!"}
```

### מעקב דרך MT5
פתח את **אפליקציית MT5 בטלפון** - תראה את כל העסקאות שה-EA פתח.

---

## 9. VPS חינמי - כדי שה-EA ירוץ 24/7

ה-EA צריך ש-MT5 יהיה פתוח כל הזמן. בגלל שאין לך מחשב, אתה צריך VPS (שרת וירטואלי). יש כמה אפשרויות חינמיות:

### אפשרות 1: Oracle Cloud Free Tier (מומלץ - חינם לנצח)
1. הירשם ב-**Oracle Cloud** (דורש כרטיס אשראי לאימות, לא מחייב)
2. צור **VM Instance** בתוכנית Always Free:
   - Shape: `VM.Standard.E2.1.Micro` (חינם לנצח)
   - Image: **Windows Server**
   - 1 GB RAM, 1 CPU - מספיק ל-MT5
3. התחבר ב-**Remote Desktop** מהטלפון (אפליקציית **RD Client**)
4. התקן MT5 על ה-VPS
5. התקן את ה-EA (שלב 4)
6. השאר MT5 פתוח - הוא ירוץ 24/7

### אפשרות 2: VPS מ-MQL5 (מתוך MT5)
1. פתח MT5 (אפילו בפעם אחת ממחשב של חבר)
2. בגרף, לחץ ימני על ה-EA
3. בחר **Virtual Hosting** → **Register**
4. עלות: ~$10/חודש (לא חינם אבל מאוד נוח)
5. MT5 מעביר את ה-EA לענן - אין צורך במחשב

### אפשרות 3: Amazon AWS Free Tier
1. הירשם ב-**AWS** (דורש כרטיס אשראי)
2. צור **EC2 Instance** - Windows Server
3. t2.micro - **חינם 12 חודשים**
4. התחבר דרך Remote Desktop מהטלפון
5. התקן MT5 + EA

### חיבור לVPS מהטלפון
- **Android:** הורד **Microsoft Remote Desktop** מ-Google Play
- **iPhone:** הורד **Microsoft Remote Desktop** מ-App Store
- הכנס IP של ה-VPS + שם משתמש + סיסמה
- תוכל לשלוט ב-VPS מלא מהטלפון

---

## 10. פתרון בעיות

### השרת לא מגיב
1. פתח את כתובת השרת בדפדפן
2. אם Render מראה "Suspended" - היכנס ל-Render והפעל מחדש
3. בתוכנית חינמית, השרת "נרדם" אחרי 15 דקות. פתרון: השתמש ב-**UptimeRobot** (חינם) לעשות ping כל 5 דקות

### ה-EA לא מקבל סיגנלים
1. בדוק בלשונית **Experts** ב-MT5 אם יש שגיאות
2. ודא ש-**AutoTrading** מופעל (ירוק)
3. ודא שהוספת את כתובת השרת ב-**Tools → Options → Expert Advisors → WebRequest**
4. בדוק ש-`ServerURL` ו-`WebhookSecret` נכונים בהגדרות ה-EA
5. בדוק ב-`/queue?secret=...` אם יש סיגנלים ממתינים

### העסקה לא נפתחת
1. בדוק בלשונית **Experts** - ה-EA מדפיס הודעות שגיאה
2. בדוק שהסימבול נכון (בדיוק כמו שהוא מופיע ב-MT5)
3. בדוק שלא הגעת למקסימום עסקאות
4. בדוק שגודל הלוט תקין (לא קטן/גדול מדי לסימבול)
5. בדוק שיש מספיק מרג'ין חופשי בחשבון

### TradingView לא שולח התראות
1. ודא שיש לך **תוכנית Pro** (חינמי לא תומך webhook)
2. בדוק שה-**Webhook URL** נכון: `https://your-bot.onrender.com/webhook`
3. בדוק שפורמט ה-**JSON תקין** (אפשר לבדוק ב-jsonlint.com)
4. ודא שההתראה **פעילה** (לא מושבתת)

### Render - השרת נרדם
בתוכנית חינמית, השרת נכבה אחרי 15 דקות ללא פעילות.

**פתרונות:**
- **UptimeRobot** (חינם): הירשם ב-uptimerobot.com, הוסף monitor מסוג HTTP שפונה לכתובת השרת כל 5 דקות
- שדרג ל-Render Paid ($7/חודש)

---

## 11. שאלות נפוצות

### ש: כמה זה עולה בסך הכל?
**ת:** רק TradingView Pro (~$13/חודש). כל השאר חינם:
- שרת Render: חינם
- VPS (Oracle Cloud): חינם לנצח
- ה-EA: חינם (כלול בבוט)

### ש: האם זה בטוח?
**ת:** כן. הבוט משתמש ב-webhook secret - בלי הסיסמה, אף אחד לא יכול לשלוח פקודות. אבל תמיד תשתמש ב-SL!

### ש: כמה מהר העסקה נפתחת?
**ת:** בדרך כלל 3-5 שניות מרגע שהאינדיקטור שולח סיגנל. ה-EA בודק כל 3 שניות (ניתן לשנות).

### ש: האם אפשר לסחור על כמה זוגות?
**ת:** כן! צור התראה נפרדת בTradingView לכל זוג מט"ח. ה-EA מבצע עסקאות על כל סימבול.

### ש: מה קורה אם ה-VPS נכבה?
**ת:** ה-EA יפסיק לקרוא סיגנלים. הסיגנלים יישמרו בתור על השרת ויבוצעו ברגע שה-EA יחזור. אבל שים לב - סיגנל ישן עלול להיות לא רלוונטי!

### ש: האם FTMO מאשרים שימוש בבוט?
**ת:** FTMO מאפשרים שימוש ב-Expert Advisors. הבוט הזה הוא EA סטנדרטי. **בדוק את התקנון העדכני של FTMO**.

### ש: אפשר להריץ בלי VPS?
**ת:** ה-EA צריך MT5 פתוח. אם תפתח MT5 על VPS חינמי (Oracle Cloud), הוא רץ 24/7 בלי להפריע לך.

---

## תרשים זרימה מלא

```
┌──────────────────┐
│   TradingView     │
│   (אינדיקטור)     │
└────────┬─────────┘
         │ Alert webhook
         ▼
┌──────────────────┐
│  שרת הבוט (Render) │
│  POST /webhook    │
│                   │
│ 1. בדיקת secret  │
│ 2. פיענוח פקודה  │
│ 3. שמירה בתור    │
└────────┬─────────┘
         │ סיגנל בתור
         │
    ┌────▼────┐
    │  תור    │
    │ סיגנלים │
    └────┬────┘
         │ EA polls GET /signal
         ▼
┌──────────────────┐
│   MT5 + EA        │
│  (על VPS חינמי)   │
│                   │
│ 1. קורא סיגנל   │
│ 2. מבצע עסקה    │
│ 3. מאשר לשרת    │
│                   │
│  ✅ עסקה נפתחת!   │
└──────────────────┘
```

---

## רשימת קבצי הפרויקט

| קובץ | איפה | תפקיד |
|------|------|--------|
| `app.py` | שרת (Render) | מקבל webhooks, שומר סיגנלים בתור |
| `config.py` | שרת (Render) | הגדרות השרת |
| `requirements.txt` | שרת (Render) | חבילות Python |
| `Procfile` | שרת (Render) | הוראות הפעלה |
| `runtime.txt` | שרת (Render) | גרסת Python |
| `TradingViewBot.mq5` | MT5 (VPS) | ה-EA שמבצע עסקאות |

---

**בהצלחה במסחר!**

> **אזהרה חשובה:** מסחר בשוק ההון כרוך בסיכון. הבוט הוא כלי טכני בלבד ולא מהווה ייעוץ השקעות. אתה האחראי הבלעדי על ההחלטות הפיננסיות שלך. **תמיד תתחיל עם חשבון דמו!**
