# מדריך למשתמש - בוט מסחר TradingView → MT5

## תוכן עניינים
1. [סקירה כללית](#1-סקירה-כללית)
2. [דרישות מקדימות](#2-דרישות-מקדימות)
3. [הגדרת חשבון MetaApi](#3-הגדרת-חשבון-metaapi)
4. [העלאת הבוט לשרת ענן (Render)](#4-העלאת-הבוט-לשרת-ענן-render)
5. [הגדרת התראות TradingView](#5-הגדרת-התראות-ב-tradingview)
6. [פורמט ההודעות (JSON)](#6-פורמט-ההודעות-json)
7. [ניהול סיכונים](#7-ניהול-סיכונים)
8. [מעקב ובקרה מהטלפון](#8-מעקב-ובקרה-מהטלפון)
9. [פתרון בעיות](#9-פתרון-בעיות)
10. [שאלות נפוצות](#10-שאלות-נפוצות)

---

## 1. סקירה כללית

### מה הבוט עושה?
הבוט מקבל התראות (alerts) מאינדיקטורים ב-TradingView ומבצע פקודות מסחר אוטומטיות בחשבון MT5 שלך ב-FTMO.

### איך זה עובד?
```
TradingView Alert → Webhook (שרת ענן) → MetaApi → MT5 (FTMO)
```

1. **האינדיקטור שלך** ב-TradingView מזהה סיגנל מסחר
2. **TradingView** שולח התראה (webhook) לשרת הבוט
3. **הבוט** מקבל את ההתראה ומפענח את הפקודה
4. **MetaApi** מתחבר לחשבון MT5 שלך ומבצע את העסקה
5. **אתה** יכול לעקוב אחרי הכל מהטלפון

### למה צריך שרת ענן?
כי אין לך מחשב פתוח 24/7. השרת רץ בענן בחינם ומחכה לסיגנלים מ-TradingView.

---

## 2. דרישות מקדימות

מה שאתה צריך (הכל מהטלפון):

| דרישה | פרטים |
|--------|--------|
| חשבון TradingView | תוכנית **Pro** או יותר (כדי לקבל webhooks) |
| חשבון FTMO | חשבון MT5 פעיל |
| חשבון MetaApi | חינם - https://metaapi.cloud |
| חשבון Render | חינם - https://render.com |
| חשבון GitHub | חינם - https://github.com |

> **חשוב:** TradingView חינמי לא תומך ב-webhooks. צריך לפחות תוכנית Pro.

---

## 3. הגדרת חשבון MetaApi

MetaApi הוא שירות ענן שמאפשר לגשת לחשבון MT5 שלך בלי צורך במחשב עם MT5 פתוח.

### שלב 3.1 - הרשמה
1. היכנס ל: https://metaapi.cloud
2. לחץ **Sign Up**
3. הירשם עם אימייל וסיסמה

### שלב 3.2 - קבלת API Token
1. אחרי ההרשמה, היכנס לדשבורד
2. לך ל-**Settings** (הגדרות)
3. תראה **API Token** - העתק אותו ושמור אותו
4. זה ה-`METAAPI_TOKEN` שלך

### שלב 3.3 - חיבור חשבון MT5
1. בדשבורד של MetaApi, לחץ **New Account**
2. מלא את הפרטים:
   - **Name:** FTMO (או שם שאתה בוחר)
   - **Type:** MetaTrader 5
   - **Login:** מספר החשבון שלך ב-MT5 (FTMO נתנו לך)
   - **Password:** הסיסמה של חשבון MT5 (שהוקצתה על ידי FTMO)
   - **Server:** שם השרת של FTMO (למשל: `FTMO-Server` - תמצא ב-MT5 שלך)
   - **Platform:** mt5
3. לחץ **Create Account**
4. חכה שהסטטוס יהיה **Deployed**
5. העתק את ה-**Account ID** - זה ה-`METAAPI_ACCOUNT_ID` שלך

> **איפה מוצאים את פרטי MT5?**
> - פתח את אפליקציית MT5 בטלפון
> - לך להגדרות → חשבונות
> - שם תראה את מספר החשבון, הסיסמה והשרת

---

## 4. העלאת הבוט לשרת ענן (Render)

### שלב 4.1 - העלאה ל-GitHub
1. היכנס ל-GitHub מהטלפון
2. צור **Repository חדש** (פרטי)
3. העלה את כל הקבצים מתיקיית `trading-bot`:
   - `app.py`
   - `mt5_trader.py`
   - `config.py`
   - `requirements.txt`
   - `Procfile`
   - `runtime.txt`

> **אל תעלה את קובץ `.env`!** הוא מכיל סיסמאות.

### שלב 4.2 - הגדרת Render
1. היכנס ל: https://render.com
2. לחץ **Sign Up** → התחבר עם GitHub
3. לחץ **New** → **Web Service**
4. בחר את ה-Repository שיצרת
5. הגדר:
   - **Name:** `my-trading-bot` (או שם אחר)
   - **Runtime:** Python 3
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `gunicorn app:app --bind 0.0.0.0:$PORT --workers 1`
   - **Plan:** Free

### שלב 4.3 - הגדרת משתני סביבה (Environment Variables)
ב-Render, לך ל-**Environment** והוסף:

| Key | Value | הסבר |
|-----|-------|-------|
| `METAAPI_TOKEN` | הטוקן מ-MetaApi | מסעיף 3.2 |
| `METAAPI_ACCOUNT_ID` | ה-ID מ-MetaApi | מסעיף 3.3 |
| `WEBHOOK_SECRET` | סיסמה שאתה בוחר | למשל: `MySecret123!` |
| `DEFAULT_LOT_SIZE` | `0.01` | גודל לוט ברירת מחדל |
| `MAX_LOT_SIZE` | `1.0` | גודל לוט מקסימלי |
| `MAX_OPEN_TRADES` | `5` | מספר עסקאות פתוחות מקסימלי |
| `DEFAULT_SL_PIPS` | `50` | סטופ לוס ברירת מחדל (בפיפס) |
| `DEFAULT_TP_PIPS` | `100` | טייק פרופיט ברירת מחדל (בפיפס) |

6. לחץ **Deploy**
7. חכה שהסטטוס יהיה **Live**
8. תקבל כתובת כמו: `https://my-trading-bot.onrender.com`

> **שמור את הכתובת הזו!** היא ה-URL של ה-webhook.

---

## 5. הגדרת התראות ב-TradingView

### שלב 5.1 - הגדרת התראה בסיסית
1. פתח את TradingView בטלפון
2. פתח את הגרף עם האינדיקטור שלך
3. לחץ על **Alert** (סמל הפעמון)
4. הגדר את התנאי (condition) של האינדיקטור

### שלב 5.2 - הגדרת Webhook
1. בהגדרות ההתראה, סמן **Webhook URL**
2. הכנס את כתובת הבוט + `/webhook`:
   ```
   https://my-trading-bot.onrender.com/webhook
   ```

### שלב 5.3 - הגדרת הודעת ההתראה (Message)
בשדה **Message**, הכנס JSON בפורמט הבא:

**לפקודת קנייה (BUY):**
```json
{
  "secret": "MySecret123!",
  "action": "buy",
  "symbol": "EURUSD",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```

**לפקודת מכירה (SELL):**
```json
{
  "secret": "MySecret123!",
  "action": "sell",
  "symbol": "EURUSD",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```

**לסגירת כל העסקאות על סימבול:**
```json
{
  "secret": "MySecret123!",
  "action": "close",
  "symbol": "EURUSD"
}
```

**לסגירת כל העסקאות:**
```json
{
  "secret": "MySecret123!",
  "action": "close_all"
}
```

### שלב 5.4 - שימוש עם משתני TradingView
אם האינדיקטור שלך מייצר סיגנלים דינמיים, אפשר להשתמש ב-placeholders:
```json
{
  "secret": "MySecret123!",
  "action": "{{strategy.order.action}}",
  "symbol": "{{ticker}}",
  "lot_size": 0.01,
  "sl_pips": 50,
  "tp_pips": 100
}
```

> **הערה:** `{{strategy.order.action}}` מחזיר `buy` או `sell` אוטומטית לפי האסטרטגיה.

---

## 6. פורמט ההודעות (JSON)

### פקודות נתמכות

| פקודה | action | שדות נדרשים | שדות אופציונליים |
|--------|--------|-------------|-----------------|
| קנייה | `buy` | `symbol` | `lot_size`, `sl_pips`, `tp_pips` |
| מכירה | `sell` | `symbol` | `lot_size`, `sl_pips`, `tp_pips` |
| סגירת סימבול | `close` | `symbol` | `position_id` |
| סגירת הכל | `close_all` | - | - |

### סימבולים נפוצים

| סימבול | שם |
|--------|-----|
| `EURUSD` | EUR/USD |
| `GBPUSD` | GBP/USD |
| `USDJPY` | USD/JPY |
| `XAUUSD` | זהב |
| `US30` | Dow Jones |
| `NAS100` | Nasdaq |

> **חשוב:** הסימבול חייב להתאים בדיוק לשם ב-MT5. בדוק באפליקציית MT5 שלך.

---

## 7. ניהול סיכונים

הבוט כולל מספר מנגנוני הגנה:

### הגבלות מובנות
- **MAX_LOT_SIZE:** הבוט לא יפתח עסקה גדולה מהמקסימום שהגדרת
- **MAX_OPEN_TRADES:** הבוט יסרב לפתוח עסקאות חדשות אם הגעת למקסימום
- **סטופ לוס אוטומטי:** כל עסקה נפתחת עם SL (ברירת מחדל או שנשלח בהודעה)
- **טייק פרופיט אוטומטי:** כל עסקה נפתחת עם TP (ברירת מחדל או שנשלח בהודעה)

### המלצות ל-FTMO
- **גודל לוט:** התחל עם 0.01 ותעלה בהדרגה
- **סטופ לוס:** תמיד תשתמש ב-SL! FTMO דורשים ניהול סיכונים
- **הפסד יומי:** שים לב למגבלת ההפסד היומי של FTMO (5%)
- **הפסד מקסימלי:** שים לב למגבלת ההפסד הכולל של FTMO (10%)
- **מספר עסקאות:** אל תפתח יותר מדי עסקאות במקביל

> **אזהרה:** הבוט לא מחליף שיקול דעת! תמיד בדוק שהאינדיקטור עובד טוב לפני שאתה נותן לו לסחור באופן אוטומטי. תתחיל עם חשבון דמו.

---

## 8. מעקב ובקרה מהטלפון

### בדיקת סטטוס הבוט
פתח בדפדפן בטלפון:
```
https://my-trading-bot.onrender.com/
```
אם תראה `{"status": "running"}` - הבוט עובד!

### צפייה בסטטוס החשבון
```
https://my-trading-bot.onrender.com/status
```
מראה: יתרה, אקוויטי, מרג'ין, ועסקאות פתוחות.

### צפייה בהיסטוריית עסקאות
```
https://my-trading-bot.onrender.com/trades
```
מראה את 100 העסקאות האחרונות.

### עקוב דרך MT5
פתח את אפליקציית MT5 בטלפון ותראה את כל העסקאות שהבוט פתח.

---

## 9. פתרון בעיות

### הבוט לא מגיב
1. בדוק שהכתובת בדפדפן מחזירה תשובה (`/`)
2. אם Render מראה "Suspended" - הפעל מחדש
3. בתוכנית חינמית של Render, הבוט "נרדם" אחרי 15 דקות ללא פעילות. יש לו כמה שניות להתעורר

### העסקה לא נפתחת
1. בדוק ב-`/trades` אם ההודעה הגיעה
2. בדוק שה-`secret` בהודעה תואם למה שהגדרת
3. בדוק שהסימבול נכון (בדיוק כמו ב-MT5)
4. בדוק ב-MetaApi שהחשבון מחובר (Deployed)
5. בדוק שלא הגעת למקסימום עסקאות פתוחות

### שגיאת חיבור ל-MT5
1. ודא שפרטי ה-MT5 נכונים ב-MetaApi (לוגין, סיסמה, שרת)
2. בדוק שחשבון FTMO פעיל
3. נסה להתנתק ולהתחבר מחדש ב-MetaApi

### TradingView לא שולח התראות
1. ודא שיש לך תוכנית Pro (או יותר)
2. בדוק שה-Webhook URL נכון
3. בדוק שפורמט ה-JSON תקין (אפשר לבדוק ב-jsonlint.com)
4. ודא שההתראה פעילה (לא מושבתת)

### Render - השירות נרדם
בתוכנית החינמית, השרת נכבה אחרי 15 דקות ללא פעילות.
**פתרונות:**
- שדרג ל-Render Paid ($7/חודש) - השרת רץ 24/7
- השתמש בשירות חיצוני כמו UptimeRobot (חינם) שעושה ping כל 5 דקות

---

## 10. שאלות נפוצות

### ש: כמה עולה להפעיל את הבוט?
**ת:** אפשר בחינם! MetaApi יש תוכנית חינמית (עד חשבון MT5 אחד), ו-Render יש שרת חינמי. רק TradingView Pro עולה כסף (~$13/חודש).

### ש: האם זה בטוח?
**ת:** הבוט משתמש ב-webhook secret כדי למנוע גישה לא מורשית. אף אחד לא יכול לשלוח פקודות בלי הסיסמה. אבל תמיד תשתמש ב-SL!

### ש: האם אפשר לסחור על כמה זוגות במקביל?
**ת:** כן! פשוט צור התראה נפרדת לכל זוג מט"ח עם הסימבול המתאים.

### ש: מה קורה אם האינטרנט נופל?
**ת:** הבוט רץ בענן, אז הוא לא תלוי באינטרנט שלך. הוא תלוי בשרתי Render שהם אמינים מאוד.

### ש: האם FTMO מאשרים שימוש בבוט?
**ת:** FTMO מאפשרים שימוש ב-Expert Advisors וב-copy trading. בוט webhook נחשב כ-EA. עדיין, **בדוק את התקנון העדכני של FTMO** לפני השימוש.

### ש: מה קורה אם יש שגיאה?
**ת:** הבוט רושם את כל הפעולות. אפשר לראות את הלוג ב-`/trades`. אם עסקה נכשלת, הבוט לא ינסה שוב אוטומטית.

---

## תרשים זרימה מלא

```
┌─────────────────┐
│   TradingView    │
│   (אינדיקטור)    │
└────────┬────────┘
         │ Alert fires
         ▼
┌─────────────────┐
│  Webhook POST   │
│  (JSON payload) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   שרת הבוט      │
│  (Render Cloud)  │
│                  │
│ 1. בדיקת secret │
│ 2. פיענוח פקודה │
│ 3. בדיקת סיכון  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│    MetaApi       │
│   (Cloud API)    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│      MT5         │
│   (FTMO Account) │
│                  │
│  ✅ עסקה נפתחת   │
└─────────────────┘
```

---

## רשימת קבצי הפרויקט

| קובץ | תפקיד |
|------|--------|
| `app.py` | השרת הראשי - מקבל webhooks ומנהל הכל |
| `mt5_trader.py` | מודול המסחר - מתחבר ל-MT5 דרך MetaApi |
| `config.py` | הגדרות - קורא משתני סביבה |
| `requirements.txt` | רשימת חבילות Python |
| `Procfile` | הוראות הפעלה ל-Render |
| `runtime.txt` | גרסת Python |
| `.env.example` | דוגמה לקובץ הגדרות מקומי |

---

**בהצלחה במסחר!** 🚀

> **הערה חשובה:** מסחר בשוק ההון כרוך בסיכון. הבוט הוא כלי טכני בלבד ולא מהווה ייעוץ השקעות. אתה האחראי הבלעדי על ההחלטות הפיננסיות שלך.
